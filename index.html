<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>旅のしおり（2/25–2/27）</title>
  <style>
    :root{
      /* ===== Light theme (white-based) ===== */
      --bg:#f6f7fb;
      --card:#ffffff;
      --muted:#5f6b80;
      --text:#0b1220;
      --line:rgba(11,18,32,.10);
      --accent:#2f6bff;
      --accent2:#00a36c;
      --warn:#b15a00;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif;
      background:
        radial-gradient(1200px 600px at 20% 0%, rgba(47,107,255,.10), transparent 55%),
        radial-gradient(1000px 500px at 80% 10%, rgba(0,163,108,.08), transparent 60%),
        var(--bg);
      color:var(--text);
    }
    header{
      padding:28px 16px 12px;
      max-width:1100px; margin:0 auto;
    }
    .title{
      display:flex; align-items:flex-end; gap:12px; flex-wrap:wrap;
    }
    h1{margin:0; font-size:26px; letter-spacing:.02em}
    .subtitle{color:var(--muted); font-size:14px; margin-top:6px}
    .toolbar{
      margin-top:16px; display:flex; gap:10px; flex-wrap:wrap;
      align-items:center;
    }
    .btn{
      border:1px solid var(--line);
      background:rgba(11,18,32,.03);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:600;
      transition:.15s;
    }
    .btn:hover{transform:translateY(-1px); background:rgba(11,18,32,.06)}
    .btn.primary{border-color:rgba(47,107,255,.45); background:rgba(47,107,255,.10)}
    .btn.danger{border-color:rgba(220,38,38,.35); background:rgba(220,38,38,.08)}
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 10px; border:1px solid var(--line);
      border-radius:999px; color:var(--muted); font-size:12px;
      background:rgba(11,18,32,.02);
    }
    main{max-width:1100px; margin:0 auto; padding:12px 16px 40px}
    .grid{
      display:grid; grid-template-columns: 1fr; gap:14px;
    }
    @media(min-width:960px){
      .grid{grid-template-columns: 1.1fr .9fr}
      .sticky{position:sticky; top:14px}
    }
    .card{
      border:1px solid var(--line);
      background: var(--card);
      border-radius:18px;
      overflow:hidden;
      box-shadow: 0 10px 30px rgba(11,18,32,.08);
    }
    .card-h{
      padding:14px 14px 10px;
      border-bottom:1px solid var(--line);
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
      background: linear-gradient(180deg, rgba(47,107,255,.06), rgba(255,255,255,0));
    }
    .card-h h2{
      margin:0; font-size:16px;
    }
    .card-h small{color:var(--muted)}
    .card-b{padding:12px 14px 14px}
    .meta{
      display:flex; gap:8px; flex-wrap:wrap; margin-top:8px;
    }
    .meta .tag{
      font-size:12px; color:var(--muted);
      border:1px solid var(--line);
      border-radius:999px;
      padding:6px 10px;
      background:rgba(11,18,32,.02);
    }
    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      overflow:hidden;
      border:1px solid var(--line);
      border-radius:14px;
      background:rgba(11,18,32,.02);
    }
    thead th{
      text-align:left;
      font-size:12px;
      color:var(--muted);
      padding:10px 10px;
      border-bottom:1px solid var(--line);
      background:rgba(11,18,32,.03);
    }
    tbody td{
      padding:10px 10px;
      border-bottom:1px solid rgba(11,18,32,.07);
      vertical-align:top;
      font-size:14px;
    }
    tbody tr:last-child td{border-bottom:none}
    .time{white-space:nowrap; color:rgba(11,18,32,.92); font-variant-numeric: tabular-nums}
    .place{color:var(--muted); font-size:12px; margin-top:2px}
    .note{color:rgba(11,18,32,.80); font-size:12px; margin-top:4px}
    .cost{
      display:flex; align-items:center; gap:8px; justify-content:flex-end;
      white-space:nowrap;
    }
    input[type="number"]{
      width:120px;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#fff;
      color:var(--text);
      outline:none;
      font-size:14px;
      font-variant-numeric: tabular-nums;
    }
    input[type="number"]:focus{border-color:rgba(47,107,255,.55); box-shadow: 0 0 0 3px rgba(47,107,255,.16)}
    .yen{color:var(--muted); font-size:12px}

    /* number入力の上下ボタンを消す（見た目が「点」っぽく見える環境対策） */
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button{
      -webkit-appearance: none;
      margin: 0;
    }
    input[type="number"]{ -moz-appearance: textfield; }

    .totals{
      display:grid; gap:10px;
    }
    .stat{
      padding:12px 12px;
      border:1px solid var(--line);
      border-radius:16px;
      background:rgba(11,18,32,.02);
    }
    .stat .k{color:var(--muted); font-size:12px}
    .stat .v{font-size:20px; font-weight:800; margin-top:6px; font-variant-numeric: tabular-nums}
    .stat .v span{color:var(--muted); font-size:12px; font-weight:700; margin-left:6px}
    .sep{height:1px; background:var(--line); margin:10px 0}
    .hint{
      color:var(--muted);
      font-size:12px;
      line-height:1.6;
    }
    .warn{
      border-color:rgba(177,90,0,.28);
      background:rgba(255,231,198,.55);
      color:rgba(80,40,0,.95);
    }
    .footer{
      margin-top:18px; color:var(--muted); font-size:12px; text-align:center;
    }
    .right{ text-align:right }
  </style>
</head>

<body>
<header>
  <div class="title">
    <h1>旅のしおり（四国・関西周遊）</h1>
    <span class="pill" id="datePill">2026/02/25–2026/02/27</span>
  </div>
  <div class="subtitle">
    各イベントの右側に「実費」を入力すると、日別・合計が自動計算されます（この端末に自動保存）。
  </div>

  <div class="toolbar">
    <button class="btn primary" id="copyBtn">共有用リンク風テキストをコピー</button>
    <button class="btn" id="exportBtn">費用データを書き出し（JSON）</button>
    <button class="btn" id="importBtn">費用データを読み込み（JSON）</button>
    <button class="btn danger" id="resetBtn">入力を全消去</button>
    <span class="pill">保存先: このブラウザ（localStorage）</span>
  </div>
</header>

<main>
  <div class="grid">
    <!-- 左：行程 -->
    <section class="card">
      <div class="card-h">
        <div>
          <h2>タイムスケジュール</h2>
          <small>※目安。道路状況・混雑で前後します。</small>
        </div>
        <div class="pill">費用入力 → 自動集計</div>
      </div>

      <div class="card-b">
        <!-- Day 1 -->
        <div class="card" style="margin-bottom:12px">
          <div class="card-h">
            <div>
              <h2>2/25（神戸 → 鳴門 → 徳島泊）</h2>
              <small>うだつの町並み削除版</small>
              <div class="meta">
                <span class="tag">神戸空港 8:40着</span>
                <span class="tag">渦潮</span>
                <span class="tag">淡路島SA</span>
                <span class="tag">徳島市内</span>
                <span class="tag">cottage coliberty</span>
              </div>
            </div>
            <div class="right">
              <div class="pill">日計: <strong id="sum-day1">0</strong> 円</div>
            </div>
          </div>
          <div class="card-b">
            <table>
              <thead>
                <tr>
                  <th style="width:92px">時間</th>
                  <th>イベント</th>
                  <th class="right" style="width:220px">実費（円）</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="time">8:40</td>
                  <td>
                    神戸空港 到着
                    <div class="place">神戸空港</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day1" data-key="d1_0840_arrive" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="time">9:00</td>
                  <td>
                    レンタカー出発
                    <div class="note">燃料/高速/駐車は次の欄でまとめてもOK</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day1" data-key="d1_0900_car" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="time">10:00</td>
                  <td>
                    淡路島SA（休憩）
                    <div class="place">淡路SA</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day1" data-key="d1_1000_awaji_sa" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="time">11:00</td>
                  <td>
                    鳴門（渦潮）
                    <div class="note">観潮船 or 渦の道（入場料など）</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day1" data-key="d1_1100_uzushio" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="time">12:30</td>
                  <td>
                    昼食（鳴門周辺）
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day1" data-key="d1_1230_lunch" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>

                <!-- ★ここを書き換え：徳島市内散策 -->
                <tr>
                  <td class="time">16:00</td>
                  <td>
                    徳島市内 散策（眉山・阿波おどり会館・徳島駅周辺など）
                    <div class="place">徳島市</div>
                    <div class="note">行きたい所をここにまとめてOK（入館料/ロープウェイ/カフェ等）</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <!-- キーは互換のためそのまま -->
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day1" data-key="d1_1600_option" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="time">18:00</td>
                  <td>
                    cottage coliberty チェックイン
                    <div class="place">徳島</div>
                    <div class="note">宿代（現地支払い分があれば）</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day1" data-key="d1_1800_hotel" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="time">自由</td>
                  <td>
                    高速・ガソリン・駐車（まとめ）
                    <div class="note">細かく入れるのが面倒ならここに合算</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day1" data-key="d1_misc" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Day 2 -->
        <div class="card" style="margin-bottom:12px">
          <div class="card-h">
            <div>
              <h2>2/26（徳島 → 香川うどん → 父母ヶ浜 → 今治 → しまなみ → 道後泊）</h2>
              <small>8:00宿出発 / 日の出製麺所は11:00–12:00（10:00着で並ぶ）</small>
              <div class="meta">
                <span class="tag">日の出製麺所</span>
                <span class="tag">がもう</span>
                <span class="tag">父母ヶ浜</span>
                <span class="tag">今治</span>
                <span class="tag">しまなみ</span>
                <span class="tag">道後温泉</span>
              </div>
            </div>
            <div class="right">
              <div class="pill">日計: <strong id="sum-day2">0</strong> 円</div>
            </div>
          </div>
          <div class="card-b">
            <table>
              <thead>
              <tr>
                <th style="width:92px">時間</th>
                <th>イベント</th>
                <th class="right" style="width:220px">実費（円）</th>
              </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="time">8:00</td>
                  <td>宿 出発</td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day2" data-key="d2_0800_depart" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">10:00</td>
                  <td>
                    日の出製麺所 到着（並ぶ）
                    <div class="place">香川・坂出</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day2" data-key="d2_1000_hinode_arrive" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">11:00</td>
                  <td>
                    うどん① 日の出製麺所（11:00–12:00）
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day2" data-key="d2_1100_hinode" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">12:30</td>
                  <td>
                    うどん②（がもう）
                    <div class="place">香川</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day2" data-key="d2_1230_udon2" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">14:15</td>
                  <td>
                    父母ヶ浜
                    <div class="place">香川・三豊</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day2" data-key="d2_1415_chichibugahama" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">16:00</td>
                  <td>
                    今治（今治城 / タオル系など）
                    <div class="place">愛媛・今治</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day2" data-key="d2_1600_imabari" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">17:00</td>
                  <td>
                    しまなみ海道ドライブ（愛媛側中心）
                    <div class="note">行き先を伸ばすほど遅れやすいので注意</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day2" data-key="d2_1700_shimanami" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">18:30</td>
                  <td>
                    道後グランドホテル チェックイン
                    <div class="note">宿代（現地支払い分があれば）</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day2" data-key="d2_1830_hotel" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">19:30</td>
                  <td>
                    道後温泉本館 入浴
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day2" data-key="d2_1930_dogo" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">自由</td>
                  <td>
                    高速・ガソリン・駐車（まとめ）
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day2" data-key="d2_misc" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
            <div class="hint" style="margin-top:10px">
              ※父母ヶ浜は干潮の時間で「鏡面」になりやすさが変わります。写真重視なら当日の干潮時刻に合わせて順番入れ替えがおすすめ。
            </div>
          </div>
        </div>

        <!-- Day 3 -->
        <div class="card">
          <div class="card-h">
            <div>
              <h2>2/27（道後 → 姫路城 → 有馬温泉 → 神戸空港 21:15発）</h2>
              <small>帰路は渋滞を見て早め行動が安心</small>
              <div class="meta">
                <span class="tag">姫路城</span>
                <span class="tag">有馬温泉</span>
                <span class="tag">21:15離陸</span>
              </div>
            </div>
            <div class="right">
              <div class="pill">日計: <strong id="sum-day3">0</strong> 円</div>
            </div>
          </div>

          <div class="card-b">
            <table>
              <thead>
              <tr>
                <th style="width:92px">時間</th>
                <th>イベント</th>
                <th class="right" style="width:220px">実費（円）</th>
              </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="time">8:30</td>
                  <td>道後 出発</td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day3" data-key="d3_0830_depart" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">11:30</td>
                  <td>
                    姫路城（見学）
                    <div class="place">兵庫・姫路</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day3" data-key="d3_1130_himeji" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">13:30</td>
                  <td>
                    有馬温泉（立ち寄り）
                    <div class="place">兵庫・神戸</div>
                    <div class="note">入浴・食べ歩き・駐車など（まとめてもOK）</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day3" data-key="d3_1330_kobe" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">18:30</td>
                  <td>
                    レンタカー返却
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day3" data-key="d3_1830_return" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">19:30</td>
                  <td>
                    神戸空港 到着
                    <div class="note">お土産・空港飯など</div>
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day3" data-key="d3_1930_airport" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">21:15</td>
                  <td>
                    神戸空港 離陸 ✈️
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day3" data-key="d3_2115_flight" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="time">自由</td>
                  <td>
                    高速・ガソリン・駐車（まとめ）
                  </td>
                  <td class="right">
                    <div class="cost">
                      <input type="number" min="0" step="1" inputmode="numeric" data-day="day3" data-key="d3_misc" placeholder="0" />
                      <span class="yen">円</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>

            <div class="hint warn stat" style="margin-top:12px">
              <div class="k">注意（帰り）</div>
              <div style="margin-top:6px">
                渋滞・事故があると神戸方面は読めないので、神戸空港は<strong>19:30着</strong>キープが安心（荷物預け/保安検査の余裕）。
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 右：集計 & 共有 -->
    <aside class="sticky">
      <section class="card">
        <div class="card-h">
          <div>
            <h2>費用サマリー</h2>
            <small>入力すると自動更新</small>
          </div>
          <div class="pill">円</div>
        </div>
        <div class="card-b">
          <div class="totals">
            <div class="stat">
              <div class="k">合計（3日間）</div>
              <div class="v"><span id="sum-all">0</span><span>円</span></div>
            </div>

            <div class="stat">
              <div class="k">2/25 合計</div>
              <div class="v"><span id="sum-day1-dup">0</span><span>円</span></div>
            </div>

            <div class="stat">
              <div class="k">2/26 合計</div>
              <div class="v"><span id="sum-day2-dup">0</span><span>円</span></div>
            </div>

            <div class="stat">
              <div class="k">2/27 合計</div>
              <div class="v"><span id="sum-day3-dup">0</span><span>円</span></div>
            </div>

            <div class="sep"></div>

            <div class="hint">
              <strong>共有のコツ：</strong><br/>
              このHTMLを <em>Google Drive / Dropbox / GitHub Pages</em> に置くか、LINE/Discordでファイル送付すると、みんなが見られます。<br/>
              ただし <u>費用入力は各自の端末に保存</u> される仕様です（みんなで同じ金額を共有したい場合は、右上の「書き出し(JSON)」を使ってやり取りしてね）。
            </div>
          </div>

          <div class="footer">© Trip Itinerary (local-only)</div>
        </div>
      </section>
    </aside>
  </div>
</main>

<script>
  // ====== Simple budget tracker (localStorage) ======
  const STORAGE_KEY = "shiori_costs_v1";

  const yen = (n) => (Math.round(n)).toLocaleString("ja-JP");
  const parseNum = (v) => {
    const n = Number(v);
    return Number.isFinite(n) && n > 0 ? n : 0;
  };

  const inputs = Array.from(document.querySelectorAll('input[type="number"][data-key]'));
  const state = loadState();

  // hydrate inputs
  for (const el of inputs) {
    const k = el.dataset.key;
    if (state[k] != null) el.value = state[k];
  }

  // listeners
  inputs.forEach((el) => {
    el.addEventListener("input", () => {
      const k = el.dataset.key;
      state[k] = parseNum(el.value);
      saveState(state);
      recalc();
    });
  });

  // Buttons
  document.getElementById("resetBtn").addEventListener("click", () => {
    if (!confirm("入力した費用をすべて消去します。よろしいですか？")) return;
    for (const el of inputs) el.value = "";
    saveState({});
    Object.keys(state).forEach(k => delete state[k]);
    recalc();
  });

  document.getElementById("exportBtn").addEventListener("click", async () => {
    const data = JSON.stringify(state, null, 2);
    await navigator.clipboard.writeText(data);
    alert("費用データ（JSON）をクリップボードにコピーしました。\n必要ならメモやLINEに貼って共有できます。");
  });

  document.getElementById("importBtn").addEventListener("click", () => {
    const pasted = prompt("書き出したJSONを貼り付けてください（例: {\"d1_...\": 1200} ）");
    if (!pasted) return;
    try {
      const obj = JSON.parse(pasted);
      if (obj && typeof obj === "object") {
        // clear then merge
        for (const k of Object.keys(state)) delete state[k];
        for (const [k,v] of Object.entries(obj)) state[k] = parseNum(v);
        // update inputs
        for (const el of inputs) {
          const k = el.dataset.key;
          el.value = state[k] ? state[k] : "";
        }
        saveState(state);
        recalc();
        alert("読み込み完了！");
      }
    } catch (e) {
      alert("JSONの形式が正しくありませんでした。");
    }
  });

  document.getElementById("copyBtn").addEventListener("click", async () => {
    const text =
`【旅のしおり】2/25–2/27（神戸→鳴門→徳島（市内散策）→香川うどん（日の出→がもう）→父母ヶ浜→今治→しまなみ→道後→姫路→有馬温泉→神戸空港）
このHTMLを開くとタイムスケジュールが見られます。右の欄に実費入力で合計が出ます（入力は端末ごとに保存）。
費用をみんなで揃える場合は「書き出し(JSON)」→共有→「読み込み(JSON)」で統一できます。`;
    await navigator.clipboard.writeText(text);
    alert("共有用テキストをコピーしました！");
  });

  function loadState(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return {};
      const obj = JSON.parse(raw);
      return obj && typeof obj === "object" ? obj : {};
    } catch { return {}; }
  }
  function saveState(obj){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(obj));
  }

  function sumByDay(day){
    let s = 0;
    for (const el of inputs) {
      if (el.dataset.day !== day) continue;
      s += parseNum(el.value);
    }
    return s;
  }

  function recalc(){
    const d1 = sumByDay("day1");
    const d2 = sumByDay("day2");
    const d3 = sumByDay("day3");
    const all = d1 + d2 + d3;

    document.getElementById("sum-day1").textContent = yen(d1);
    document.getElementById("sum-day2").textContent = yen(d2);
    document.getElementById("sum-day3").textContent = yen(d3);

    document.getElementById("sum-all").textContent = yen(all);
    document.getElementById("sum-day1-dup").textContent = yen(d1);
    document.getElementById("sum-day2-dup").textContent = yen(d2);
    document.getElementById("sum-day3-dup").textContent = yen(d3);
  }

  recalc();
</script>
</body>
</html>
